<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<section class="luxo-list-container fadein">
  <header class="list-header">
    <div class="header-content">
      <span class="category-tag">Gestão de Transações</span>
      <h1>Histórico de Vendas VIP</h1>
    </div>
    <button pButton label="NOVA VENDA" icon="pi pi-plus" class="p-button-black" routerLink="/vendas/novo-pedido"></button>
  </header>

  <div class="luxo-card">
    <p-table
      [value]="vendas"
      [rows]="10"
      [paginator]="true"
      responsiveLayout="stack"
      [breakpoint]="'960px'"
      styleClass="p-datatable-sm">

      <ng-template pTemplate="header">
        <tr>
          <th scope="col">DATA</th>
          <th scope="col">PROTOCOLO</th>
          <th scope="col">CLIENTE</th>
          <th scope="col" class="text-right">VALOR TOTAL</th>
          <th scope="col" class="text-center">STATUS</th>
          <th scope="col"></th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-pedido>
        <tr [class.row-cancelled]="pedido.status === 'CANCELADO'">
          <td>{{ pedido.dataHora | date:'dd/MM/yyyy HH:mm' }}</td>
          <td><strong class="protocol-text">{{ pedido.protocolo }}</strong></td>
          <td>
            <div class="cliente-info">
              <span>{{ pedido.cliente.nome }}</span>
              <small>{{ pedido.cliente.perfil }}</small>
            </div>
          </td>
          <td class="text-right"><strong>{{ pedido.valorTotal | currency:'BRL' }}</strong></td>
          <td class="text-center">
            <p-tag [value]="pedido.status" [severity]="getSeverity(pedido.status)"></p-tag>
          </td>
          <td class="text-center">
            <button
              *ngIf="pedido.status !== 'CANCELADO'"
              pButton
              icon="pi pi-times"
              class="p-button-rounded p-button-danger p-button-text"
              pTooltip="Cancelar Venda"
              tooltipPosition="left"
              (click)="confirmarCancelamento(pedido)">
            </button>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="6" class="text-center p-5">
            Nenhuma venda realizada até o momento.
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</section>
